<!DOCTYPE html>
<html>
<head>
    <title>WoW Class Polls</title>
    <style>
        body {
            background-color: #1a1f2b;
            color: white;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        .settings {
            margin-bottom: 20px;
            padding: 10px;
            background-color: #2c3142;
            border-radius: 5px;
        }

        .webhook-input {
            width: 300px;
            padding: 5px;
            margin-right: 10px;
            background-color: #1a1f2b;
            border: 1px solid #3d4356;
            color: white;
            border-radius: 3px;
        }

        h1, h2 {
            color: #00b0f4;
        }

        .class-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .class-box {
            background-color: #2c3142;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #3d4356;
        }

        input[type="number"] {
            background-color: #1a1f2b;
            border: 1px solid #3d4356;
            color: white;
            padding: 5px;
            width: 60px;
            margin: 0 5px;
            border-radius: 3px;
        }

        .status-message {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 20px;
            border-radius: 5px;
            display: none;
            animation: fadeOut 3s forwards;
        }

        .success {
            background-color: #43b581;
            color: white;
        }

        .error {
            background-color: #f04747;
            color: white;
        }

        @keyframes fadeOut {
            0% { opacity: 1; }
            70% { opacity: 1; }
            100% { opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="settings">
        <input type="text" id="webhookUrl" class="webhook-input" placeholder="Enter Discord Webhook URL">
    </div>

    <h1>World of Warcraft Class Polls</h1>

    <h2>Mists of Pandaria Classes (5.4.8)</h2>
    <div class="class-grid">
        <div class="class-box">
            <span>Warrior</span>
            <input type="number" id="mop-warrior" value="0" min="0" max="100" onchange="updateDiscord()">%
        </div>
        <div class="class-box">
            <span>Paladin</span>
            <input type="number" id="mop-paladin" value="0" min="0" max="100" onchange="updateDiscord()">%
        </div>
        <!-- Add all other MOP classes similarly -->
    </div>

    <h2>Wrath of the Lich King Classes</h2>
    <div class="class-grid">
        <div class="class-box">
            <span>Warrior</span>
            <input type="number" id="wotlk-warrior" value="0" min="0" max="100" onchange="updateDiscord()">%
        </div>
        <div class="class-box">
            <span>Paladin</span>
            <input type="number" id="wotlk-paladin" value="0" min="0" max="100" onchange="updateDiscord()">%
        </div>
        <!-- Add all other WOTLK classes similarly -->
    </div>

    <div id="statusMessage" class="status-message"></div>

    <script>
        let updateTimeout;

        function showStatus(message, isError = false) {
            const statusElement = document.getElementById('statusMessage');
            statusElement.textContent = message;
            statusElement.className = 'status-message ' + (isError ? 'error' : 'success');
            statusElement.style.display = 'block';
            
            setTimeout(() => {
                statusElement.style.display = 'none';
            }, 3000);
        }

        function updateDiscord() {
            clearTimeout(updateTimeout);
            updateTimeout = setTimeout(() => {
                const webhookUrl = document.getElementById('webhookUrl').value;
                if (!webhookUrl) {
                    showStatus('Please enter a Discord webhook URL', true);
                    return;
                }

                const mopData = {
                    warrior: document.getElementById('mop-warrior').value,
                    paladin: document.getElementById('mop-paladin').value,
                    // Add all other MOP classes
                };

                const wotlkData = {
                    warrior: document.getElementById('wotlk-warrior').value,
                    paladin: document.getElementById('wotlk-paladin').value,
                    // Add all other WOTLK classes
                };

                const embed = {
                    title: "WoW Class Distribution Stats",
                    color: 3447003,
                    fields: [
                        {
                            name: "__Mists of Pandaria (5.4.8)__",
                            value: `ðŸ—¡ï¸ **Warrior:** ${mopData.warrior}%\n` +
                                   `ðŸ›¡ï¸ **Paladin:** ${mopData.paladin}%\n` +
                                   // Add all other MOP classes
                            inline: true
                        },
                        {
                            name: "__Wrath of the Lich King__",
                            value: `ðŸ—¡ï¸ **Warrior:** ${wotlkData.warrior}%\n` +
                                   `ðŸ›¡ï¸ **Paladin:** ${wotlkData.paladin}%\n` +
                                   // Add all other WOTLK classes
                            inline: true
                        }
                    ],
                    timestamp: new Date().toISOString(),
                    footer: {
                        text: "Last updated"
                    }
                };

                fetch(webhookUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ embeds: [embed] })
                })
                .then(response => {
                    if (response.ok) {
                        showStatus('Updated Discord successfully!');
                    } else {
                        showStatus('Failed to update Discord', true);
                    }
                })
                .catch(error => {
                    showStatus('Error updating Discord: ' + error.message, true);
                });
            }, 1000); // Waits 1 second after the last change before posting
        }

        // Save webhook URL to localStorage
        document.getElementById('webhookUrl').value = localStorage.getItem('webhookUrl') || '';
        document.getElementById('webhookUrl').addEventListener('change', (e) => {
            localStorage.setItem('webhookUrl', e.target.value);
        });
    </script>
</body>
</html>
